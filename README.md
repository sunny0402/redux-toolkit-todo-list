# Add Features Branch (Step 2/3)

# TODO:

New components:
Single to-do component
New Features:
Add a new to-do.
Edit to-do item. Such as updating the category.
Swap the order of to-do items.
Get to-do items by category.
Remove a to-do.
Remove all todos from a particular cateogry.

# How we'll do it

Let's start by implemening a component which will display an individual to-do, not just a list of todos.

<SingleTodoPage>

After creating the SingleTodoPage component let's add routing to this component in App.js.

```
    <Route path="/todos/:todoId" element={<SingleTodoPage />} />
```

# Add a to-do

First create a form and then connect the form the Redux store.

```
<Route path="/addTodo" element={<AddTodoForm />} />
```

In todoSlice.js we need to add a reducer function which will handle saving the to-do to our app state.
To save, aka update state, we need the current state and an action object which has the new info. The action object will be dispatched by out AddTodoForm component.

Again the UI our component dispatches an action which updates the app state. That's it.

```
  reducers: {
    createTodo(state, action) {
      state.push(action.payload);
    },
  },
```

We have some things to import to our AddTodoForm component.

```
import { useDispatch } from "react-redux";
import { nanoid } from "@reduxjs/toolkit";

import { createTodo } from "./todoSlice";
```

The important part is that we dispatch an action which updates the Redux store.

```
  //   update app state by creating a new todo
  const onSaveTodoClicked = () => {
    if (title && notes && category) {
      //   update state
      dispatch(
        createTodo({
          id: nanoid(),
          title: title,
          notes: notes,
          category: category,
        })
      );
      // clear input fields
      setTitle("");
      setNotes("");
      setCategory("");
    }
  };
```

Convince yourself, that this works by visiting dev tools.

# Edit a to-do

<EditPostForm>

When adding a feature need to create a new reducer function. And an action which the componen will then dispatch.

{type: 'posts/postUpdated', payload: {id, title, content}}

By default, the action creators generated by createSlice expect you to pass in one argument, and that value will be put into the action object as action.payload.

Reducer updates state based on the action dispatched to it.

We also know that the reducer is responsible for determining how the state should actually be updated when an action is dispatched.

createSlice creates action creators which UI components can dispatch.

Finally, we'll need to export the action creator function that createSlice generated for us, so that the UI can dispatch the new postUpdated action when the user saves the post.

1. todoSlice.js

```
    updateTodo(state, action) {
      const { id, title, notes, category } = action.payload;
      const todo2Update = state.find((a_todo) => a_todo.id === id);
      if (todo2Update) {
        todo2Update.title = title;
        todo2Update.notes = notes;
        todo2Update.category = category;
      }
    },

    export const { createTodo, updateTodo } = todoSlice.actions;
```

2. EditTodoForm.js

```
//add code
```

3. Update App.js

```
import { EditTodoForm } from "./features/todo/EditTodoForm";
<Route path="editTodo/:todoId" element={EditTodoForm} />
```

4. Update the single to-do component

```
<Link to={`editTodo/${todoId}`} />
```

To edit a post need to retreive right post from Redux store.

??? We'll also use React Router's history API to switch over to the single post page and show that post.

# Extra Features ...

Color code todos.
Add a timer to a to-do.

TimeTodo.js

```
import React, { useState, useEffect } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { setTime } from './timeSlice';

function Time() {
  const [duration, setDuration] = useState(0); // added this line
  const time = useSelector(state => state.time.currentTime);
  const dispatch = useDispatch();

  useEffect(() => {
    const interval = setInterval(() => {
      setDuration(duration - 1);
    }, 1000);
    return () => clearInterval(interval);
  }, [duration]); // added this line

  function handleSetTime(event) {
    event.preventDefault();
    const form = event.target;
    const data = new FormData(form);
    const newDuration = data.get("duration");
    setDuration(newDuration);
  }

  return (
    <div>
      <p>The countdown timer is at: {duration} seconds</p>
      <form onSubmit={handleSetTime}>
        <label htmlFor="duration">Enter duration in seconds:</label>
        <input id="duration" name="duration" type="number" />
        <button type="submit">Set Time</button>
      </form>
    </div>
  );
}

export default Time;
```
